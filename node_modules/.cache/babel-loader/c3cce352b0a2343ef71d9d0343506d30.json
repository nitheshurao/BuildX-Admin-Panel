{"ast":null,"code":"import _toConsumableArray from\"/Users/redhan/Desktop/work/Ecom-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/redhan/Desktop/work/Ecom-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/redhan/Desktop/work/Ecom-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useCallback,useState,useRef,useEffect}from'react';import moment from'moment';import FullCalendar from'@fullcalendar/react';import dayGridPlugin from'@fullcalendar/daygrid';import timeGridPlugin from'@fullcalendar/timegrid';import interactionPlugin from'@fullcalendar/interaction';import listPlugin from'@fullcalendar/list';import timelinePlugin from'@fullcalendar/timeline';import{Box,Container,Paper,useTheme,useMediaQuery,makeStyles}from'@material-ui/core';import'@fullcalendar/core/main.css';import'@fullcalendar/daygrid/main.css';import'@fullcalendar/timegrid/main.css';import'@fullcalendar/list/main.css';import axios from'src/utils/axios';import useIsMountedRef from'src/hooks/useIsMountedRef';import Page from'src/components/Page';import Header from'./Header';import Toolbar from'./Toolbar';import AddEditEventModal from'./AddEditEventModal';var useStyles=makeStyles(function(theme){return{root:{backgroundColor:theme.palette.background.dark,minHeight:'100%',paddingTop:theme.spacing(3),paddingBottom:theme.spacing(3)},calendar:{'& .fc-unthemed th':{borderColor:theme.palette.divider},'& .fc-unthemed td':{borderColor:theme.palette.divider},'& .fc-unthemed td.fc-today':{backgroundColor:theme.palette.background.dark},'& .fc-head':{backgroundColor:theme.palette.background.dark},'& .fc-body':{backgroundColor:theme.palette.background.default},'& .fc-axis':_objectSpread({},theme.typography.body2),'& .fc-list-item-time':_objectSpread({},theme.typography.body2),'& .fc-list-item-title':_objectSpread({},theme.typography.body1),'& .fc-list-heading-main':_objectSpread({},theme.typography.h6),'& .fc-list-heading-alt':_objectSpread({},theme.typography.h6),'& .fc th':{borderColor:theme.palette.divider},'& .fc-day-header':_objectSpread({},theme.typography.subtitle2,{fontWeight:theme.typography.fontWeightMedium,color:theme.palette.text.secondary,padding:theme.spacing(1),backgroundColor:theme.palette.background.dark}),'& .fc-day-top':_objectSpread({},theme.typography.body2),'& .fc-highlight':{backgroundColor:theme.palette.background.dark},'& .fc-event':{backgroundColor:theme.palette.secondary.main,color:theme.palette.secondary.contrastText,borderWidth:2,opacity:0.9,'& .fc-time':_objectSpread({},theme.typography.h6,{color:'inherit'}),'& .fc-title':_objectSpread({},theme.typography.body1,{color:'inherit'})},'& .fc-list-empty':_objectSpread({},theme.typography.subtitle1)}};});function CalendarView(){var classes=useStyles();var calendarRef=useRef(null);var isMountedRef=useIsMountedRef();var theme=useTheme();var mobileDevice=useMediaQuery(theme.breakpoints.down('sm'));var _useState=useState(mobileDevice?'listWeek':'dayGridMonth'),_useState2=_slicedToArray(_useState,2),view=_useState2[0],setView=_useState2[1];var _useState3=useState(moment().toDate()),_useState4=_slicedToArray(_useState3,2),date=_useState4[0],setDate=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),events=_useState6[0],setEvents=_useState6[1];var _useState7=useState({event:null,mode:null,open:false}),_useState8=_slicedToArray(_useState7,2),modal=_useState8[0],setModal=_useState8[1];var resetModal=function resetModal(){setModal({event:null,mode:null,open:false});};var handleDateToday=function handleDateToday(){var calendarEl=calendarRef.current;if(calendarEl){var calendarApi=calendarEl.getApi();calendarApi.today();setDate(calendarApi.getDate());}};var handleViewChange=function handleViewChange(newView){var calendarEl=calendarRef.current;if(calendarEl){var calendarApi=calendarEl.getApi();calendarApi.changeView(newView);setView(newView);}};var handleDatePrev=function handleDatePrev(){var calendarEl=calendarRef.current;if(calendarEl){var calendarApi=calendarEl.getApi();calendarApi.prev();setDate(calendarApi.getDate());}};var handleDateNext=function handleDateNext(){var calendarEl=calendarRef.current;if(calendarEl){var calendarApi=calendarEl.getApi();calendarApi.next();setDate(calendarApi.getDate());}};var handleEventAddClick=function handleEventAddClick(){setModal({mode:'add',open:true,event:{allDay:false,description:'',end:moment().add(30,'minutes').toDate(),start:moment().toDate(),title:''}});};var handleSlotsSelect=function handleSlotsSelect(arg){var calendarEl=calendarRef.current;if(calendarEl){var calendarApi=calendarEl.getApi();calendarApi.unselect();}setModal({event:{allDay:arg.allDay,description:'',end:arg.end,start:arg.start,title:''},mode:'add',open:true});};var handleEventAdd=function handleEventAdd(event){setEvents(function(prevEvents){return[].concat(_toConsumableArray(prevEvents),[event]);});resetModal();};var handleEventDelete=function handleEventDelete(eventId){setEvents(function(prevEvents){return prevEvents.filter(function(prevEvent){return prevEvent.id!==eventId;});});resetModal();};var handleEventSelect=function handleEventSelect(arg){var event=events.find(function(e){return e.id===arg.event.id;});setModal({event:_objectSpread({},event),mode:'edit',open:true});};var handleEventEdit=function handleEventEdit(event){setEvents(function(prevEvents){return prevEvents.map(function(prevEvent){return prevEvent.id===event.id?event:prevEvent;});});resetModal();};var handleEventResize=function handleEventResize(_ref){var event=_ref.event;// Call API to update the event in database\nsetEvents(function(prevEvents){return prevEvents.map(function(prevEvent){return prevEvent.id===event.id?_objectSpread({},prevEvent,{allDay:event.allDay,start:event.start,end:event.end}):prevEvent;});});};var handleEventDrop=function handleEventDrop(_ref2){var event=_ref2.event;// If you add a droppable area, check if event dropped inside or outside of calendar\n// Call API to update the event in database\nsetEvents(function(prevEvents){return prevEvents.map(function(prevEvent){return prevEvent.id===event.id?_objectSpread({},prevEvent,{allDay:event.allDay,start:event.start,end:event.end}):prevEvent;});});};var handleModalClose=function handleModalClose(){resetModal();};var getEvents=useCallback(function(){axios.get('/api/calendar').then(function(response){if(isMountedRef.current){setEvents(response.data.events);}});},[isMountedRef]);useEffect(function(){getEvents();},[getEvents]);useEffect(function(){var calendarEl=calendarRef.current;if(calendarEl){var calendarApi=calendarEl.getApi();var newView=mobileDevice?'listWeek':'dayGridMonth';calendarApi.changeView(newView);setView(newView);}},[mobileDevice]);if(!events){return null;}return(/*#__PURE__*/React.createElement(Page,{className:classes.root,title:\"Calendar\"},/*#__PURE__*/React.createElement(Container,{maxWidth:false},/*#__PURE__*/React.createElement(Header,{onEventAdd:handleEventAddClick}),/*#__PURE__*/React.createElement(Toolbar,{date:date,onDateNext:handleDateNext,onDatePrev:handleDatePrev,onDateToday:handleDateToday,onViewChange:handleViewChange,view:view}),/*#__PURE__*/React.createElement(Paper,{className:classes.calendar,component:Box,mt:3,p:2},/*#__PURE__*/React.createElement(FullCalendar,{allDayMaintainDuration:true,defaultDate:date,defaultView:view,droppable:true,editable:true,eventClick:handleEventSelect,eventDrop:handleEventDrop,eventLimit:true,eventResizableFromStart:true,eventResize:handleEventResize,events:events,header:false,height:800,ref:calendarRef,rerenderDelay:10,select:handleSlotsSelect,selectable:true,weekends:true,plugins:[dayGridPlugin,timeGridPlugin,interactionPlugin,listPlugin,timelinePlugin]})),/*#__PURE__*/React.createElement(AddEditEventModal,{event:modal.event,mode:modal.mode,onAdd:handleEventAdd,onCancel:handleModalClose,onDelete:handleEventDelete,onEdit:handleEventEdit,open:modal.open}))));}export default CalendarView;","map":{"version":3,"sources":["/Users/redhan/Desktop/work/Ecom-Admin/src/views/calendar/CalendarView/index.js"],"names":["React","useCallback","useState","useRef","useEffect","moment","FullCalendar","dayGridPlugin","timeGridPlugin","interactionPlugin","listPlugin","timelinePlugin","Box","Container","Paper","useTheme","useMediaQuery","makeStyles","axios","useIsMountedRef","Page","Header","Toolbar","AddEditEventModal","useStyles","theme","root","backgroundColor","palette","background","dark","minHeight","paddingTop","spacing","paddingBottom","calendar","borderColor","divider","default","typography","body2","body1","h6","subtitle2","fontWeight","fontWeightMedium","color","text","secondary","padding","main","contrastText","borderWidth","opacity","subtitle1","CalendarView","classes","calendarRef","isMountedRef","mobileDevice","breakpoints","down","view","setView","toDate","date","setDate","events","setEvents","event","mode","open","modal","setModal","resetModal","handleDateToday","calendarEl","current","calendarApi","getApi","today","getDate","handleViewChange","newView","changeView","handleDatePrev","prev","handleDateNext","next","handleEventAddClick","allDay","description","end","add","start","title","handleSlotsSelect","arg","unselect","handleEventAdd","prevEvents","handleEventDelete","eventId","filter","prevEvent","id","handleEventSelect","find","e","handleEventEdit","map","handleEventResize","handleEventDrop","handleModalClose","getEvents","get","then","response","data"],"mappings":"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","sourcesContent":["import React, {\n  useCallback,\n  useState,\n  useRef,\n  useEffect\n} from 'react';\nimport moment from 'moment';\nimport FullCalendar from '@fullcalendar/react';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport timeGridPlugin from '@fullcalendar/timegrid';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport listPlugin from '@fullcalendar/list';\nimport timelinePlugin from '@fullcalendar/timeline';\nimport {\n  Box,\n  Container,\n  Paper,\n  useTheme,\n  useMediaQuery,\n  makeStyles\n} from '@material-ui/core';\nimport '@fullcalendar/core/main.css';\nimport '@fullcalendar/daygrid/main.css';\nimport '@fullcalendar/timegrid/main.css';\nimport '@fullcalendar/list/main.css';\nimport axios from 'src/utils/axios';\nimport useIsMountedRef from 'src/hooks/useIsMountedRef';\nimport Page from 'src/components/Page';\nimport Header from './Header';\nimport Toolbar from './Toolbar';\nimport AddEditEventModal from './AddEditEventModal';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    backgroundColor: theme.palette.background.dark,\n    minHeight: '100%',\n    paddingTop: theme.spacing(3),\n    paddingBottom: theme.spacing(3)\n  },\n  calendar: {\n    '& .fc-unthemed th': {\n      borderColor: theme.palette.divider\n    },\n    '& .fc-unthemed td': {\n      borderColor: theme.palette.divider\n    },\n    '& .fc-unthemed td.fc-today': {\n      backgroundColor: theme.palette.background.dark\n    },\n    '& .fc-head': {\n      backgroundColor: theme.palette.background.dark\n    },\n    '& .fc-body': {\n      backgroundColor: theme.palette.background.default\n    },\n    '& .fc-axis': {\n      ...theme.typography.body2\n    },\n    '& .fc-list-item-time': {\n      ...theme.typography.body2\n    },\n    '& .fc-list-item-title': {\n      ...theme.typography.body1\n    },\n    '& .fc-list-heading-main': {\n      ...theme.typography.h6\n    },\n    '& .fc-list-heading-alt': {\n      ...theme.typography.h6\n    },\n    '& .fc th': {\n      borderColor: theme.palette.divider\n    },\n    '& .fc-day-header': {\n      ...theme.typography.subtitle2,\n      fontWeight: theme.typography.fontWeightMedium,\n      color: theme.palette.text.secondary,\n      padding: theme.spacing(1),\n      backgroundColor: theme.palette.background.dark\n    },\n    '& .fc-day-top': {\n      ...theme.typography.body2\n    },\n    '& .fc-highlight': {\n      backgroundColor: theme.palette.background.dark\n    },\n    '& .fc-event': {\n      backgroundColor: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      borderWidth: 2,\n      opacity: 0.9,\n      '& .fc-time': {\n        ...theme.typography.h6,\n        color: 'inherit'\n      },\n      '& .fc-title': {\n        ...theme.typography.body1,\n        color: 'inherit'\n      }\n    },\n    '& .fc-list-empty': {\n      ...theme.typography.subtitle1\n    }\n  }\n}));\n\nfunction CalendarView() {\n  const classes = useStyles();\n  const calendarRef = useRef(null);\n  const isMountedRef = useIsMountedRef();\n  const theme = useTheme();\n  const mobileDevice = useMediaQuery(theme.breakpoints.down('sm'));\n  const [view, setView] = useState(mobileDevice ? 'listWeek' : 'dayGridMonth');\n  const [date, setDate] = useState(moment().toDate());\n  const [events, setEvents] = useState(null);\n  const [modal, setModal] = useState({\n    event: null,\n    mode: null,\n    open: false\n  });\n\n  const resetModal = () => {\n    setModal({\n      event: null,\n      mode: null,\n      open: false\n    });\n  };\n\n  const handleDateToday = () => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.today();\n      setDate(calendarApi.getDate());\n    }\n  };\n\n  const handleViewChange = (newView) => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.changeView(newView);\n      setView(newView);\n    }\n  };\n\n  const handleDatePrev = () => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.prev();\n      setDate(calendarApi.getDate());\n    }\n  };\n\n  const handleDateNext = () => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.next();\n      setDate(calendarApi.getDate());\n    }\n  };\n\n  const handleEventAddClick = () => {\n    setModal({\n      mode: 'add',\n      open: true,\n      event: {\n        allDay: false,\n        description: '',\n        end: moment().add(30, 'minutes').toDate(),\n        start: moment().toDate(),\n        title: ''\n      }\n    });\n  };\n\n  const handleSlotsSelect = (arg) => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.unselect();\n    }\n\n    setModal({\n      event: {\n        allDay: arg.allDay,\n        description: '',\n        end: arg.end,\n        start: arg.start,\n        title: ''\n      },\n      mode: 'add',\n      open: true\n    });\n  };\n\n  const handleEventAdd = (event) => {\n    setEvents((prevEvents) => [...prevEvents, event]);\n    resetModal();\n  };\n\n  const handleEventDelete = (eventId) => {\n    setEvents((prevEvents) => prevEvents.filter((prevEvent) => prevEvent.id !== eventId));\n    resetModal();\n  };\n\n  const handleEventSelect = (arg) => {\n    const event = events.find((e) => e.id === arg.event.id);\n\n    setModal({\n      event: { ...event },\n      mode: 'edit',\n      open: true\n    });\n  };\n\n  const handleEventEdit = (event) => {\n    setEvents((prevEvents) => prevEvents.map((prevEvent) => (\n      prevEvent.id === event.id ? event : prevEvent\n    )));\n    resetModal();\n  };\n\n  const handleEventResize = ({ event }) => {\n    // Call API to update the event in database\n    setEvents((prevEvents) => prevEvents.map((prevEvent) => (prevEvent.id === event.id ? ({\n      ...prevEvent,\n      allDay: event.allDay,\n      start: event.start,\n      end: event.end\n    }) : prevEvent)));\n  };\n\n  const handleEventDrop = ({ event }) => {\n    // If you add a droppable area, check if event dropped inside or outside of calendar\n    // Call API to update the event in database\n    setEvents((prevEvents) => prevEvents.map((prevEvent) => (prevEvent.id === event.id ? ({\n      ...prevEvent,\n      allDay: event.allDay,\n      start: event.start,\n      end: event.end\n    }) : prevEvent)));\n  };\n\n  const handleModalClose = () => {\n    resetModal();\n  };\n\n  const getEvents = useCallback(() => {\n    axios\n      .get('/api/calendar')\n      .then((response) => {\n        if (isMountedRef.current) {\n          setEvents(response.data.events);\n        }\n      });\n  }, [isMountedRef]);\n\n  useEffect(() => {\n    getEvents();\n  }, [getEvents]);\n\n  useEffect(() => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n      const newView = mobileDevice ? 'listWeek' : 'dayGridMonth';\n\n      calendarApi.changeView(newView);\n      setView(newView);\n    }\n  }, [mobileDevice]);\n\n  if (!events) {\n    return null;\n  }\n\n  return (\n    <Page\n      className={classes.root}\n      title=\"Calendar\"\n    >\n      <Container maxWidth={false}>\n        <Header onEventAdd={handleEventAddClick} />\n        <Toolbar\n          date={date}\n          onDateNext={handleDateNext}\n          onDatePrev={handleDatePrev}\n          onDateToday={handleDateToday}\n          onViewChange={handleViewChange}\n          view={view}\n        />\n        <Paper\n          className={classes.calendar}\n          component={Box}\n          mt={3}\n          p={2}\n        >\n          <FullCalendar\n            allDayMaintainDuration\n            defaultDate={date}\n            defaultView={view}\n            droppable\n            editable\n            eventClick={handleEventSelect}\n            eventDrop={handleEventDrop}\n            eventLimit\n            eventResizableFromStart\n            eventResize={handleEventResize}\n            events={events}\n            header={false}\n            height={800}\n            ref={calendarRef}\n            rerenderDelay={10}\n            select={handleSlotsSelect}\n            selectable\n            weekends\n            plugins={[\n              dayGridPlugin,\n              timeGridPlugin,\n              interactionPlugin,\n              listPlugin,\n              timelinePlugin\n            ]}\n          />\n        </Paper>\n        <AddEditEventModal\n          event={modal.event}\n          mode={modal.mode}\n          onAdd={handleEventAdd}\n          onCancel={handleModalClose}\n          onDelete={handleEventDelete}\n          onEdit={handleEventEdit}\n          open={modal.open}\n        />\n      </Container>\n    </Page>\n  );\n}\n\nexport default CalendarView;\n"]},"metadata":{},"sourceType":"module"}